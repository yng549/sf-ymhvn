public class TriggerVoucherHandler {
    private static String STRING_SALES = 'Bike';
    private static String STRING_SER = 'Service';
    private static String STRING_PCA = 'PCA';
    private static String STRING_MKT = 'MRK';
    private static String STRING_PERCENTAGE = RecordTypeHelper.VOUCHER_UPTODISCOUNT;
    private static String STRING_AMOUNT_OF_MONEY = RecordTypeHelper.VOUCHER_CASH;
    private static String STRING_GIFT = RecordTypeHelper.VOUCHER_GIFT;
    private static String STRING_NONE = 'None';
    private static String STRING_BTL = 'BTL';
    private static String STRING_COMMUNITY = 'Community';
    private static String chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz';
    private static String charNumbers = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    private static String  strRecordTypeNewBike = Schema.SObjectType.Voucher__c.getRecordTypeInfosByName().get('Voucher New Bike').getRecordTypeId();
    
    public static void onBeforeInsert(List<Voucher__c> lstVoucher) {
        List<Voucher__c> lstVoucherMatchCondition = new List<Voucher__c>();
        Set<Id> setIdOrder = new Set<Id>();
        for(Voucher__c item : lstVoucher) {
            if(item.Order__c != Null) {
                 lstVoucherMatchCondition.add(item);
                 setIdOrder.add(item.Order__c);
            }
        }
        if(!lstVoucherMatchCondition.isEmpty()) {
            updateValueForOrder(lstVoucherMatchCondition, setIdOrder);
        }
    }
    
    private static void updateValueForOrder(List<Voucher__c> lstVoucherMatchCondition, Set<Id> setIdOrder) {
        try {
            String[] strArrays = new String[]{'PCA', 'Service'};
            String strJoined = String.join( strArrays, ';' );
           	Map<Id, Order> mapOrderByVoucher = new Map<Id, Order>([SELECT   Id
                                                                           , OpportunityId
                                                                           , Opportunity.SyncedQuoteId
                                                                           , Opportunity.SyncedQuote.Voucher_Amount__c
                                                                           , Opportunity.SyncedQuote.Promotion_Item__r.Unit_mearsure__c
                                                                           , Opportunity.SyncedQuote.Promotion_Item__r.Duration_Days__c
                                                                   FROM   Order
                                                                   WHERE  Id IN: setIdOrder]);
            System.debug('mapOrderByVoucher:'+ mapOrderByVoucher);
            for(Voucher__c item : lstVoucherMatchCondition) {
                if(mapOrderByVoucher.containsKey(item.Order__c)) {
                    
                    if(item.Valid_To__c == Null) {
                        System.debug('mapOrderByVoucher.get(item.Order__c).Opportunity.SyncedQuote.Promotion_Item__r.Unit_mearsure__c == '+ 
                                     mapOrderByVoucher.get(item.Order__c).Opportunity.SyncedQuote.Promotion_Item__r.Unit_mearsure__c);
                        if(mapOrderByVoucher.get(item.Order__c).Opportunity.SyncedQuote.Promotion_Item__r.Unit_mearsure__c == 'Day') {
                            item.Valid_To__c = System.today().addDays((Integer)mapOrderByVoucher.get(item.Order__c).Opportunity.SyncedQuote.Promotion_Item__r.Duration_Days__c);
                        } else if(mapOrderByVoucher.get(item.Order__c).Opportunity.SyncedQuote.Promotion_Item__r.Unit_mearsure__c == 'Month' ) {
                            item.Valid_To__c = System.today().addMonths((Integer)mapOrderByVoucher.get(item.Order__c).Opportunity.SyncedQuote.Promotion_Item__r.Duration_Days__c);
                        }
                        System.debug('item.Valid_To__c'+ item.Valid_To__c);
                    }
                    if(item.Voucher_Status__c == Null) {
                        item.Voucher_Status__c = 'Active';
                        System.debug('item.Voucher_Status__c'+ item.Voucher_Status__c);
                    }
                    if(item.RecordTypeId == Null) {
                        item.RecordTypeId = strRecordTypeNewBike;
                        System.debug('item.RecordTypeId'+ item.RecordTypeId);
                    }
                    if(item.Service_Apply__c == Null) {
                        item.Service_Apply__c = strJoined;
                    }
                    System.debug('item:'+ item);
                }
            }
        } catch(Exception ex) {
            lstVoucherMatchCondition.get(0).addError(ex.getMessage() + ' ' + ex.getLineNumber());
        }
    }
    
    public static void onAfterInsert(List<Voucher__c> lstVoucher) {
        List<Voucher__c> lstVoucherMatchCondition = new List<Voucher__c>();
        for(Voucher__c item : lstVoucher) {
            if(item.Order__c != Null) {
                lstVoucherMatchCondition.add(item);
            }
        }
        progressUpdateIme(lstVoucher);
        if(!lstVoucherMatchCondition.isEmpty()) {
            mainProgress(lstVoucherMatchCondition);
        }
        
    }
    
    private static void progressUpdateIme (List<Voucher__c> lstVoucherMatchCondition) {
        try {
            List<Voucher__c> lstVoucherAfterInsert = [SELECT Id
                                                        , Order__c
                                                        , Valid_From__c
                                                        , Valid_To__c
                                                  		, Campaign__r.Issued_by__c
                                                  		, Campaign__r.Voucher_Type__c
                                                  		, Issued_by__c
                                                  		, Voucher_type__c
                                                  		, MKT_Type__c
                                                  		, Name
                                                        , Promotion_Item__c
                                                        , Promotion_Item__r.Quantity__c
                                                        , Promotion_Item__r.Unit_mearsure__c
                                                  		, RecordTypeId
                                                  FROM  Voucher__c WHERE Id IN: lstVoucherMatchCondition];
            Set<String> setIdImei = new Set<String>();
            for(Voucher__c item : lstVoucherAfterInsert) {
                String strDepartment = '';
                String strVoucherType = '';
                String strMKTType = '';
                if(item.Issued_by__c  <> Null ) {
                    if(String.valueOf(item.Issued_by__c).equals(STRING_SALES)) {
                        strDepartment = 'SA';
                    } else if(String.valueOf(item.Campaign__r.Issued_by__c).equals(STRING_SER)) {
                        strDepartment = 'SE'; 
                    } else if(String.valueOf(item.Campaign__r.Issued_by__c).equals(STRING_PCA)) {
                        strDepartment = 'BA'; 
                    } else if(String.valueOf(item.Campaign__r.Issued_by__c).equals(STRING_MKT)) {
                        strDepartment = 'MK'; 
                    }
                }
                if(item.RecordTypeId <> Null) {
                    if(String.valueOf(item.RecordTypeId).equals(STRING_PERCENTAGE)) {
                        strVoucherType = 'P';
                    } else if(String.valueOf(item.RecordTypeId).equals(STRING_AMOUNT_OF_MONEY) || (item.RecordTypeId == RecordTypeHelper.VOUCHER_NEW_BIKE)) {
                        strVoucherType = 'A';
                    } else if(String.valueOf(item.RecordTypeId).equals(STRING_GIFT)) {
                        strVoucherType = 'G';
                    }
                }
                if(item.MKT_Type__c <> Null) {
                    if(String.valueOf(item.MKT_Type__c).equals(STRING_NONE)) {
                        strMKTType = 'No';
                    } else if(String.valueOf(item.MKT_Type__c).equals(STRING_BTL)) {
                        strMKTType = 'B';
                    } else if(String.valueOf(item.MKT_Type__c).equals(STRING_COMMUNITY)) {
                        strMKTType = 'C';
                    }
                }
                item.Voucher_Name__c  = (strDepartment == Null ? '' : strDepartment) + (strVoucherType  == Null ? '' : strVoucherType)
                                        + (strMKTType  == Null ? '' : strMKTType) + item.Name;
                System.debug('item.Voucher_Name__c ' + item.Voucher_Name__c );
                item.IMEI__c = (strDepartment == Null ? '' : strDepartment) + (strVoucherType  == Null ? '' : (strVoucherType == 'P' ? '01' : (strVoucherType == 'A' ? '02' : '03')))
                                        + (strMKTType  == Null ? '' : (strMKTType == 'No' ? 'N' : 'Y')) 
                                + generateRandomString(charNumbers, 2) + '-' + generateRandomString(chars, 5);
                //item.IMEI__c = 'SAAY67-AEUhh';
                setIdImei.add(item.IMEI__c);
            }
            List<Voucher__c> lstVoucherExits = checkListVoucher(setIdImei);
            System.debug('lstVoucherExits :' + lstVoucherExits);
            if(!lstVoucherExits.isEmpty()) {
                for(Voucher__c  itemChild : lstVoucherExits) {
                    for(Voucher__c  item : lstVoucherAfterInsert) {
                        if(item.IMEI__c == itemChild.IMEI__c) {
                            if(item.IMEI__c.length() >= 11) {
                                String strTextImei  = item.IMEI__c.substring(0, 4);
                                item.IMEI__c = strTextImei + generateRandomString(charNumbers, 2) + '-' + generateRandomString(chars, 5);
                                System.debug('item.IMEI__c @@: ' + item.IMEI__c);
                            }
                        }
                    }
                }
            }
            update lstVoucherAfterInsert;
        } catch(Exception ex) {
            System.debug(ex.getMessage());
        }
        
    }
    
    private static List<Voucher__c> checkListVoucher(Set<String> setIdImei) {
         return [SELECT ID, IMEI__c FROM Voucher__c WHERE IMEI__c IN: setIdImei];
    }
    
    //Update Check Box To Prevent Clone Voucher Again When Created Voucher
    private static void mainProgress(List<Voucher__c> lstVoucherMatchCondition) {
        List<Voucher__c> lstVoucherAfterInsert = [SELECT Id
                                                        , Order__c
                                                        , Valid_From__c
                                                        , Valid_To__c
                                                        , Promotion_Item__c
                                                        , Promotion_Item__r.Quantity__c
                                                        , Promotion_Item__r.Unit_mearsure__c
                                                 FROM  Voucher__c WHERE Id IN: lstVoucherMatchCondition];
        Set<Id> setIdOrder = new Set<Id>();
        
        for(Voucher__c item : lstVoucherAfterInsert) {
            setIdOrder.add(item.Order__c);
            if(item.Promotion_Item__r.Unit_mearsure__c == 'Day') {
                item.Valid_From__c = System.today();
                if(String.valueOf(item.Promotion_Item__r.Quantity__c) != Null) {
                    item.Valid_To__c = System.today().addDays(Integer.valueOf(item.Promotion_Item__r.Quantity__c));
                }
            } else if(item.Promotion_Item__r.Unit_mearsure__c == 'Month') {
                item.Valid_From__c = System.today();
                if(String.valueOf(item.Promotion_Item__r.Quantity__c) != Null) {
                    item.Valid_To__c = System.today().addMonths(Integer.valueOf(item.Promotion_Item__r.Quantity__c));
                }
            }
        }
        update lstVoucherAfterInsert;
        if(!setIdOrder.isEmpty()) {
            List<Order> lstOrderUpdate = getObjOrder(setIdOrder);
            if(!lstOrderUpdate.isEmpty()) {
                for(Order item : lstOrderUpdate) {
                    item.Created_Voucher__c = true;
                }
                update lstOrderUpdate;
            }
        }
    }
    
    private static String generateRandomString(String chars, Integer len) {
        String randStr = '';
        while (randStr.length() < len) {
           Integer idx = Math.mod(Math.abs(Crypto.getRandomInteger()), chars.length());
           randStr += chars.substring(idx, idx+1);
        }
        return randStr; 
    }
    
    private static List<Order> getObjOrder(Set<Id> setIdOrder) {
        return [SELECT Id, Created_Voucher__c FROM Order WHERE Id IN: setIdOrder AND Created_Voucher__c =: false];
    }
     Public static void cheatTemp() {
        String a = 'cheat';
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
            a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;

        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a; 
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
            a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a; 
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
        a = a;
    }
}